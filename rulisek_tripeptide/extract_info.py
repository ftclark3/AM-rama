import numpy as np
import Bio
from Bio.PDB.PDBParser import PDBParser
import os
import numba

data_dir = "P-CONF_1.6M"
alphabet = "ACDEFGHIKLMNPQRSTVWY"
parser = PDBParser(QUIET=True)

bad = [
"AAC58.pdb",
"AAC59.pdb",
"AAD44.pdb",
"AAH154.pdb",
"AAH155.pdb",
"AAH76.pdb",
"AAH94.pdb",
"AAK70.pdb",
"AAN65.pdb",
"AAQ85.pdb",
"AAS69.pdb",
"AAS87.pdb",
"AAW106.pdb",
"AAW118.pdb",
"AAW179.pdb",
"AAY183.pdb",
"ACA135.pdb",
"ACD131.pdb",
"ACE138.pdb",
"ACE171.pdb",
"ACE75.pdb",
"ACI129.pdb",
"ACK143.pdb",
"ACR107.pdb",
"ACR161.pdb",
"AFG131.pdb",
"AFG150.pdb",
"AGD140.pdb",
"AGE22.pdb",
"AGE24.pdb",
"AGF39.pdb",
"AGS35.pdb",
"AGY79.pdb",
"AGY90.pdb",
"AIC97.pdb",
"AII76.pdb",
"AIL77.pdb",
"AIL78.pdb",
"AIV102.pdb",
"AIV103.pdb",
"ALC17.pdb",
"ALD58.pdb",
"ALH12.pdb",
"ALH60.pdb",
"ALM115.pdb",
"ALM31.pdb",
"ALN46.pdb",
"ALN57.pdb",
"ALQ129.pdb",
"ALQ138.pdb",
"ALS18.pdb",
"ALS29.pdb",
"ALT14.pdb",
"ALY51.pdb",
"ALY58.pdb",
"AMA150.pdb",
"AME41.pdb",
"AME42.pdb",
"AME67.pdb",
"AMH47.pdb",
"AMH52.pdb",
"AML104.pdb",
"AMN112.pdb",
"AMQ55.pdb",
"AMQ56.pdb",
"APD95.pdb",
"APD96.pdb",
"APE67.pdb",
"APG15.pdb",
"APH94.pdb",
"API112.pdb",
"API116.pdb",
"API155.pdb",
"APY101.pdb",
"APY102.pdb",
"APY134.pdb",
"APY190.pdb",
"AVE43.pdb",
"AVE52.pdb",
"AVF98.pdb",
"AVQ110.pdb",
"AVS125.pdb",
"AVT52.pdb",
"CAD49.pdb",
"CAD55.pdb",
"CAD59.pdb",
"CAE117.pdb",
"CAE56.pdb",
"CAE65.pdb",
"CAG56.pdb",
"CAG77.pdb",
"CAG80.pdb",
"CAG87.pdb",
"CAG92.pdb",
"CAK82.pdb",
"CAK87.pdb",
"CAQ94.pdb",
"CAV127.pdb",
"CCD106.pdb",
"CCD87.pdb",
"CCD94.pdb",
"CCE140.pdb",
"CCE146.pdb",
"CCE152.pdb",
"CCN116.pdb",
"CCN20.pdb",
"CCQ175.pdb",
"CCQ21.pdb",
"CCQ25.pdb",
"CCQ27.pdb",
"CCQ97.pdb",
"CCS27.pdb",
"CCT186.pdb",
"CCT193.pdb",
"CEA100.pdb",
"CEG131.pdb",
"CEG178.pdb",
"CFA61.pdb",
"CFG112.pdb",
"CFG116.pdb",
"CFG180.pdb",
"CFG193.pdb",
"CFG71.pdb",
"CFP56.pdb",
"CFT39.pdb",
"CFT42.pdb",
"CFT43.pdb",
"CGC39.pdb",
"CGD57.pdb",
"CGE180.pdb",
"CGE190.pdb",
"CGE193.pdb",
"CGE63.pdb",
"CGE69.pdb",
"CGE72.pdb",
"CGE73.pdb",
"CHF53.pdb",
"CHK45.pdb",
"CHR44.pdb",
"CHR87.pdb",
"CHV51.pdb",
"CHW47.pdb",
"CHY109.pdb",
"CHY132.pdb",
"CHY133.pdb",
"CIA196.pdb",
"CIA27.pdb",
"CIC184.pdb",
"CIC38.pdb",
"CID69.pdb",
"CIE49.pdb",
"CIF115.pdb",
"CIF117.pdb",
"CIG108.pdb",
"CIH31.pdb",
"CIH40.pdb",
"CII45.pdb",
"CII57.pdb",
"CII79.pdb",
"CIK71.pdb",
"CIK94.pdb",
"CIL43.pdb",
"CIL55.pdb",
"CIM86.pdb",
"CIN140.pdb",
"CIP153.pdb",
"CIP154.pdb",
"CIQ125.pdb",
"CIQ27.pdb",
"CIR25.pdb",
"CIR51.pdb",
"CIR77.pdb",
"CIR92.pdb",
"CIS199.pdb",
"CIS26.pdb",
"CIV125.pdb",
"CIV181.pdb",
"CIV190.pdb",
"CIV23.pdb",
"CIV40.pdb",
"CIW103.pdb",
"CIW148.pdb",
"CIW57.pdb",
"CIW70.pdb",
"CIW85.pdb",
"CIW86.pdb",
"CIW87.pdb",
"CKC110.pdb",
"CLA23.pdb",
"CLA24.pdb",
"CLA85.pdb",
"CLA88.pdb",
"CLD128.pdb",
"CLF126.pdb",
"CLG89.pdb",
"CLL96.pdb",
"CLP117.pdb",
"CLP120.pdb",
"CLS200.pdb",
"CLT168.pdb",
"CLT169.pdb",
"CLT170.pdb",
"CLT37.pdb",
"CLY128.pdb",
"CLY129.pdb",
"CMG112.pdb",
"CMG44.pdb",
"CNE73.pdb",
"CNT101.pdb",
"CNT106.pdb",
"CNV85.pdb",
"CPD74.pdb",
"CPD99.pdb",
"CPQ96.pdb",
"CPS89.pdb",
"CQD51.pdb",
"CQS61.pdb",
"CVA59.pdb",
"CVA66.pdb",
"CVA90.pdb",
"CVC122.pdb",
"CVC143.pdb",
"CVC171.pdb",
"CVC32.pdb",
"CVC55.pdb",
"CVC56.pdb",
"CVC72.pdb",
"CVC73.pdb",
"CVC84.pdb",
"CVC98.pdb",
"CVD119.pdb",
"CVD82.pdb",
"CVD85.pdb",
"CVE66.pdb",
"CVL49.pdb",
"CVL52.pdb",
"CVN108.pdb",
"CVN137.pdb",
"CVN138.pdb",
"CVN160.pdb",
"CVN180.pdb",
"CVP80.pdb",
"CVS63.pdb",
"CVS80.pdb",
"CVT188.pdb",
"CVV105.pdb",
"CVV65.pdb",
"CVY38.pdb",
"CVY41.pdb",
"CWE64.pdb",
"CWK12.pdb",
"CWN10.pdb",
"CWN11.pdb",
"CWP32.pdb",
"CWR67.pdb",
"CWR74.pdb",
"CYA190.pdb",
"CYL193.pdb",
"CYL195.pdb",
"CYP177.pdb",
"CYR180.pdb",
"CYR181.pdb",
"CYR187.pdb",
"CYT181.pdb",
"CYT183.pdb",
"CYV166.pdb",
"CYV179.pdb",
"CYV186.pdb",
"CYY133.pdb",
"CYY154.pdb",
"CYY156.pdb",
"DIR167.pdb",
"FAK92.pdb",
"FAN83.pdb",
"FAQ170.pdb",
"FAQ172.pdb",
"FAR105.pdb",
"FAR106.pdb",
"FAR160.pdb",
"FAT186.pdb",
"FAT197.pdb",
"FCA159.pdb",
"FCG181.pdb",
"FCG189.pdb",
"FCP82.pdb",
"FCT107.pdb",
"FCT139.pdb",
"FCT178.pdb",
"FCT187.pdb",
"FCV100.pdb",
"FCV104.pdb",
"FCV110.pdb",
"FFL186.pdb",
"FFV137.pdb",
"FIA183.pdb",
"FIF83.pdb",
"FIG165.pdb",
"FIG166.pdb",
"FII176.pdb",
"FIK176.pdb",
"FIK177.pdb",
"FIM100.pdb",
"FIM151.pdb",
"FIM178.pdb",
"FIN101.pdb",
"FIN109.pdb",
"FIN49.pdb",
"FIN73.pdb",
"FIN83.pdb",
"FIQ103.pdb",
"FIR143.pdb",
"FIR154.pdb",
"FIR155.pdb",
"FIR170.pdb",
"FIV177.pdb",
"FIV191.pdb",
"FIV90.pdb",
"FIY74.pdb",
"FLA40.pdb",
"FLA41.pdb",
"FLF37.pdb",
"FLF39.pdb",
"FLF69.pdb",
"FLG41.pdb",
"FLG65.pdb",
"FLG96.pdb",
"FLH12.pdb",
"FLH39.pdb",
"FLI71.pdb",
"FLK22.pdb",
"FLK31.pdb",
"FLL41.pdb",
"FLL55.pdb",
"FLL63.pdb",
"FLM11.pdb",
"FLM14.pdb",
"FLM55.pdb",
"FLM58.pdb",
"FLN96.pdb",
"FLQ16.pdb",
"FLQ47.pdb",
"FLQ73.pdb",
"FLQ86.pdb",
"FLQ88.pdb",
"FME150.pdb",
"FRI192.pdb",
"FRW136.pdb",
"FRW137.pdb",
"FRW140.pdb",
"FRW141.pdb",
"FVA72.pdb",
"FVG184.pdb",
"FVG193.pdb",
"FVS103.pdb",
"FVS57.pdb",
"FVS59.pdb",
"FVS68.pdb",
"FVS69.pdb",
"FVS88.pdb",
"FVY160.pdb",
"FYQ182.pdb",
"GCR56.pdb",
"GDH26.pdb",
"GDH27.pdb",
"GDM34.pdb",
"GDQ35.pdb",
"GDS42.pdb",
"GDS50.pdb",
"GDS56.pdb",
"GDY32.pdb",
"GDY43.pdb",
"GEC158.pdb",
"GEC70.pdb",
"GEF62.pdb",
"GEI46.pdb",
"GEM107.pdb",
"GEM123.pdb",
"GEM128.pdb",
"GEM54.pdb",
"GEM58.pdb",
"GEP114.pdb",
"GEP122.pdb",
"GEP126.pdb",
"GEQ126.pdb",
"GEQ131.pdb",
"GEQ56.pdb",
"GER163.pdb",
"GER177.pdb",
"GER181.pdb",
"GER183.pdb",
"GET106.pdb",
"GET111.pdb",
"GET119.pdb",
"GEV125.pdb",
"GEY130.pdb",
"GEY172.pdb",
"GEY188.pdb",
"GEY198.pdb",
"GEY62.pdb",
"GFG179.pdb",
"GFH169.pdb",
"GFI168.pdb",
"GFM183.pdb",
"GFR111.pdb",
"GFS173.pdb",
"GFT24.pdb",
"GFT26.pdb",
"GFT65.pdb",
"GFT85.pdb",
"GFV116.pdb",
"GFV146.pdb",
"GFV153.pdb",
"GFW194.pdb",
"GHA127.pdb",
"GHA148.pdb",
"GHA170.pdb",
"GHA88.pdb",
"GHA92.pdb",
"GHG188.pdb",
"GHG66.pdb",
"GHG75.pdb",
"GHG86.pdb",
"GHP89.pdb",
"GKF163.pdb",
"GKF166.pdb",
"GND100.pdb",
"GNE55.pdb",
"GNF45.pdb",
"GNI99.pdb",
"GNK160.pdb",
"GNK162.pdb",
"GNK184.pdb",
"GNL28.pdb",
"GNM80.pdb",
"GNN102.pdb",
"GNN115.pdb",
"GNN119.pdb",
"GNN125.pdb",
"GNN127.pdb",
"GNN68.pdb",
"GNS32.pdb",
"GNS33.pdb",
"GNS51.pdb",
"GNT124.pdb",
"GNT128.pdb",
"GNT67.pdb",
"GNT97.pdb",
"GNV148.pdb",
"GNV60.pdb",
"GNV61.pdb",
"GNY52.pdb",
"GQA144.pdb",
"GQA145.pdb",
"GQA158.pdb",
"GQA159.pdb",
"GQA189.pdb",
"GQD109.pdb",
"GQE122.pdb",
"GQH136.pdb",
"GQH198.pdb",
"GQH86.pdb",
"GQI125.pdb",
"GQK122.pdb",
"GQK187.pdb",
"GQK73.pdb",
"GQK82.pdb",
"GQL135.pdb",
"GQM131.pdb",
"GQM72.pdb",
"GQM98.pdb",
"GQN52.pdb",
"GQP101.pdb",
"GQP125.pdb",
"GQP137.pdb",
"GQQ89.pdb",
"GQS125.pdb",
"GQT153.pdb",
"GQT155.pdb",
"GQT157.pdb",
"GQT53.pdb",
"GQT65.pdb",
"GQV91.pdb",
"GQW100.pdb",
"GQY117.pdb",
"GRS169.pdb",
"GRT195.pdb",
"GRT196.pdb",
"GRT99.pdb",
"GSF59.pdb",
"GSF64.pdb",
"GSI89.pdb",
"GSI90.pdb",
"GSL77.pdb",
"GSL90.pdb",
"GSP189.pdb",
"GSR101.pdb",
"GSR103.pdb",
"GSR105.pdb",
"GSR167.pdb",
"GSV200.pdb",
"GTH138.pdb",
"GWA98.pdb",
"GWG199.pdb",
"GWL62.pdb",
"GWS125.pdb",
"GWS129.pdb",
"GWT104.pdb",
"GYL182.pdb",
"GYL184.pdb",
"GYT117.pdb",
"GYT119.pdb",
"GYT138.pdb",
"GYT168.pdb",
"GYT173.pdb",
"GYT85.pdb",
"GYT88.pdb",
"GYT92.pdb",
"GYW170.pdb",
"GYW175.pdb",
"IDI134.pdb",
"IDI83.pdb",
"IDI84.pdb",
"IDL22.pdb",
"IDL27.pdb",
"IDL39.pdb",
"IDL58.pdb",
"IDL80.pdb",
"IDS109.pdb",
"IDY140.pdb",
"IED174.pdb",
"IED178.pdb",
"IED87.pdb",
"IEN88.pdb",
"IEN89.pdb",
"IEV134.pdb",
"IEV38.pdb",
"IHD122.pdb",
"IHF124.pdb",
"IHG36.pdb",
"IHI75.pdb",
"IHI76.pdb",
"IHK193.pdb",
"IHP95.pdb",
"IHP97.pdb",
"IHP99.pdb",
"IHS105.pdb",
"IHS115.pdb",
"IHS118.pdb",
"IHT83.pdb",
"IHV167.pdb",
"IKC146.pdb",
"IKD81.pdb",
"IKD97.pdb",
"IKH111.pdb",
"IKH146.pdb",
"IKK105.pdb",
"IKK116.pdb",
"IKK147.pdb",
"IKM112.pdb",
"IKM146.pdb",
"IKM151.pdb",
"IKM172.pdb",
"IKS123.pdb",
"IKS130.pdb",
"IKS135.pdb",
"IKS141.pdb",
"IKS195.pdb",
"IKY155.pdb",
"IKY158.pdb",
"IKY160.pdb",
"IKY162.pdb",
"IKY183.pdb",
"INY81.pdb",
"IQD113.pdb",
"IQD115.pdb",
"IQD130.pdb",
"IQE100.pdb",
"IQE99.pdb",
"IQG147.pdb",
"IQG156.pdb",
"IQG170.pdb",
"IQG172.pdb",
"IQG95.pdb",
"IQP51.pdb",
"IQP61.pdb",
"IQS109.pdb",
"IQV139.pdb",
"IQV185.pdb",
"IQV29.pdb",
"IQV98.pdb",
"IRE41.pdb",
"IRE65.pdb",
"IRF144.pdb",
"IRG162.pdb",
"IRG174.pdb",
"IRI74.pdb",
"IRK108.pdb",
"IRK109.pdb",
"IRK116.pdb",
"IRN108.pdb",
"IRN110.pdb",
"IRN111.pdb",
"IRP135.pdb",
"IRY132.pdb",
"ISE13.pdb",
"ISE141.pdb",
"ISE143.pdb",
"ISE148.pdb",
"ISE71.pdb",
"ISK91.pdb",
"ISK92.pdb",
"ISL186.pdb",
"ISL194.pdb",
"ISL84.pdb",
"ISP113.pdb",
"ISP118.pdb",
"ISP163.pdb",
"ISP179.pdb",
"ISQ108.pdb",
"ISQ114.pdb",
"ISQ127.pdb",
"ISQ133.pdb",
"ISQ139.pdb",
"ISQ140.pdb",
"ISR13.pdb",
"ISR134.pdb",
"IST10.pdb",
"IST12.pdb",
"ISV102.pdb",
"ISV15.pdb",
"ITC11.pdb",
"ITC13.pdb",
"ITC57.pdb",
"ITD34.pdb",
"ITD79.pdb",
"ITE120.pdb",
"ITE18.pdb",
"ITE20.pdb",
"ITF61.pdb",
"ITF76.pdb",
"ITH17.pdb",
"ITI23.pdb",
"ITI62.pdb",
"ITI73.pdb",
"ITK100.pdb",
"ITK18.pdb",
"ITK48.pdb",
"ITL23.pdb",
"ITL82.pdb",
"ITL86.pdb",
"ITL90.pdb",
"ITR63.pdb",
"ITR64.pdb",
"ITR70.pdb",
"ITV56.pdb",
"ITV59.pdb",
"ITV64.pdb",
"ITV83.pdb",
"ITV86.pdb",
"ITW16.pdb",
"ITW190.pdb",
"ITW194.pdb",
"ITY124.pdb",
"ITY18.pdb",
"IWD53.pdb",
"IWD68.pdb",
"IWE67.pdb",
"IWE73.pdb",
"IWE74.pdb",
"IWE77.pdb",
"IWR182.pdb",
"IWT69.pdb",
"IWT79.pdb",
"MAC182.pdb",
"MAC72.pdb",
"MAC77.pdb",
"MAD132.pdb",
"MAD71.pdb",
"MAF57.pdb",
"MAG135.pdb",
"MAI124.pdb",
"MAL128.pdb",
"MAM69.pdb",
"MAN152.pdb",
"MAN164.pdb",
"MAN75.pdb",
"MAP121.pdb",
"MAP68.pdb",
"MAP69.pdb",
"MAQ70.pdb",
"MAV115.pdb",
"MAV18.pdb",
"MAV25.pdb",
"MAY168.pdb",
"MCA128.pdb",
"MCA129.pdb",
"MCA131.pdb",
"MCC118.pdb",
"MCC134.pdb",
"MCC138.pdb",
"MCI117.pdb",
"MCI75.pdb",
"MCI83.pdb",
"MCK154.pdb",
"MCK158.pdb",
"MCK161.pdb",
"MCK169.pdb",
"MCL119.pdb",
"MCS168.pdb",
"MCT149.pdb",
"MDA113.pdb",
"MDA114.pdb",
"MDD129.pdb",
"MDD138.pdb",
"MDD41.pdb",
"MDD45.pdb",
"MDD74.pdb",
"MDD76.pdb",
"MDD84.pdb",
"MDE125.pdb",
"MDE151.pdb",
"MDE90.pdb",
"MDF88.pdb",
"MDF93.pdb",
"MDF94.pdb",
"MDG120.pdb",
"MDG132.pdb",
"MDH117.pdb",
"MDH118.pdb",
"MDH119.pdb",
"MDH174.pdb",
"MDH190.pdb",
"MDI95.pdb",
"MDL105.pdb",
"MDL93.pdb",
"MDM101.pdb",
"MDM68.pdb",
"MDN124.pdb",
"MDN126.pdb",
"MDN132.pdb",
"MDN158.pdb",
"MDN162.pdb",
"MDN177.pdb",
"MDN179.pdb",
"MDQ102.pdb",
"MDQ109.pdb",
"MDQ110.pdb",
"MDQ135.pdb",
"MDQ166.pdb",
"MDV116.pdb",
"MDY86.pdb",
"MDY99.pdb",
"MEC114.pdb",
"MEC90.pdb",
"MED119.pdb",
"MED150.pdb",
"MED167.pdb",
"MED172.pdb",
"MED92.pdb",
"MEF105.pdb",
"MEF134.pdb",
"MEH172.pdb",
"MEH176.pdb",
"MEH192.pdb",
"MEH84.pdb",
"MEH99.pdb",
"MEI80.pdb",
"MEI81.pdb",
"MEI93.pdb",
"MEK103.pdb",
"MEK82.pdb",
"MEN147.pdb",
"MEN179.pdb",
"MEN64.pdb",
"MEN97.pdb",
"MEQ104.pdb",
"MEQ194.pdb",
"MES106.pdb",
"MES114.pdb",
"MES92.pdb",
"MFA101.pdb",
"MFA104.pdb",
"MFA106.pdb",
"MFA183.pdb",
"MFA190.pdb",
"MFA58.pdb",
"MFA65.pdb",
"MFA78.pdb",
"MFD196.pdb",
"MFF168.pdb",
"MFI180.pdb",
"MFI193.pdb",
"MFL186.pdb",
"MFL52.pdb",
"MFL71.pdb",
"MFL81.pdb",
"MFP136.pdb",
"MFP149.pdb",
"MFP198.pdb",
"MFR103.pdb",
"MFR154.pdb",
"MFR155.pdb",
"MFR163.pdb",
"MFR166.pdb",
"MFR170.pdb",
"MFR99.pdb",
"MFV117.pdb",
"MFV118.pdb",
"MFV173.pdb",
"MFV174.pdb",
"MFV176.pdb",
"MFV177.pdb",
"MFV179.pdb",
"MFW59.pdb",
"MFW92.pdb",
"MGD36.pdb",
"MGF145.pdb",
"MGK26.pdb",
"MGK35.pdb",
"MGN102.pdb",
"MGP129.pdb",
"MGQ193.pdb",
"MGR33.pdb",
"MGR97.pdb",
"MGT103.pdb",
"MHP188.pdb",
"MHP190.pdb",
"MHP193.pdb",
"MHV196.pdb",
"MHV55.pdb",
"MIC127.pdb",
"MIC142.pdb",
"MIC143.pdb",
"MIC147.pdb",
"MIC153.pdb",
"MIC28.pdb",
"MIC80.pdb",
"MIH155.pdb",
"MIH81.pdb",
"MII124.pdb",
"MII38.pdb",
"MII41.pdb",
"MII45.pdb",
"MII52.pdb",
"MIK68.pdb",
"MIK72.pdb",
"MIM120.pdb",
"MIQ123.pdb",
"MIQ78.pdb",
"MIR112.pdb",
"MIR139.pdb",
"MIR181.pdb",
"MIR199.pdb",
"MIS146.pdb",
"MIS174.pdb",
"MIS27.pdb",
"MIS72.pdb",
"MIV101.pdb",
"MIV28.pdb",
"MIW146.pdb",
"MIW184.pdb",
"MIW196.pdb",
"MKG129.pdb",
"MKG153.pdb",
"MMA31.pdb",
"MMA36.pdb",
"MMD115.pdb",
"MMD124.pdb",
"MMD142.pdb",
"MMD143.pdb",
"MMG195.pdb",
"MMI107.pdb",
"MML153.pdb",
"MML177.pdb",
"MML183.pdb",
"MML84.pdb",
"MML92.pdb",
"MMN151.pdb",
"MMN156.pdb",
"MMN157.pdb",
"MMN175.pdb",
"MMV86.pdb",
"MMV96.pdb",
"MMY106.pdb",
"MMY141.pdb",
"MMY77.pdb",
"MNM42.pdb",
"MPG108.pdb",
"MPG95.pdb",
"MPG99.pdb",
"MPK78.pdb",
"MPK79.pdb",
"MPW54.pdb",
"MTS183.pdb",
"MTT146.pdb",
"MVA57.pdb",
"MVG128.pdb",
"MVN126.pdb",
"MVN139.pdb",
"MVN191.pdb",
"MVN195.pdb",
"MVN41.pdb",
"MVP129.pdb",
"MVP130.pdb",
"MVP131.pdb",
"MVP176.pdb",
"MVQ128.pdb",
"MVQ155.pdb",
"MVV55.pdb",
"MVV79.pdb",
"MWT144.pdb",
"MWT169.pdb",
"MWT40.pdb",
"MWT62.pdb",
"MWT64.pdb",
"MWT65.pdb",
"MYA103.pdb",
"MYA175.pdb",
"MYA177.pdb",
"MYA190.pdb",
"MYA197.pdb",
"MYA65.pdb",
"MYA67.pdb",
"MYA79.pdb",
"MYA91.pdb",
"MYG106.pdb",
"MYG108.pdb",
"MYG57.pdb",
"MYG60.pdb",
"MYG88.pdb",
"MYH159.pdb",
"MYH60.pdb",
"MYH88.pdb",
"MYK157.pdb",
"MYL145.pdb",
"MYR148.pdb",
"MYR164.pdb",
"MYR191.pdb",
"MYV188.pdb",
"MYV191.pdb",
"MYV194.pdb",
"PAM32.pdb",
"PDI150.pdb",
"PDK25.pdb",
"PDQ106.pdb",
"PDQ112.pdb",
"PDQ115.pdb",
"PDQ137.pdb",
"PEH119.pdb",
"PEH46.pdb",
"PEK36.pdb",
"PEN22.pdb",
"PEN25.pdb",
"PEN28.pdb",
"PEN88.pdb",
"PEN89.pdb",
"PER144.pdb",
"PER161.pdb",
"PER82.pdb",
"PER83.pdb",
"PER89.pdb",
"PER94.pdb",
"PEW149.pdb",
"PEW81.pdb",
"PEW83.pdb",
"PEW89.pdb",
"PGT111.pdb",
"PGT115.pdb",
"PGT116.pdb",
"PGT117.pdb",
"PIA139.pdb",
"PIA153.pdb",
"PIA154.pdb",
"PIA164.pdb",
"PIF71.pdb",
"PIF79.pdb",
"PIF80.pdb",
"PIG113.pdb",
"PIG72.pdb",
"PIG83.pdb",
"PII155.pdb",
"PII200.pdb",
"PIK105.pdb",
"PIK108.pdb",
"PIK110.pdb",
"PIK113.pdb",
"PIK73.pdb",
"PIM128.pdb",
"PIR141.pdb",
"PIT84.pdb",
"PKC166.pdb",
"PLC118.pdb",
"PLE101.pdb",
"PLE93.pdb",
"PLF61.pdb",
"PLF67.pdb",
"PLH175.pdb",
"PLI70.pdb",
"PLM41.pdb",
"PLM53.pdb",
"PLP62.pdb",
"PLQ54.pdb",
"PLQ55.pdb",
"PLS123.pdb",
"PLS194.pdb",
"PMA144.pdb",
"PMA148.pdb",
"PMA171.pdb",
"PMA186.pdb",
"PMC32.pdb",
"PML130.pdb",
"PMM123.pdb",
"PMV68.pdb",
"PNC90.pdb",
"PND135.pdb",
"PNE112.pdb",
"PNE114.pdb",
"PNE164.pdb",
"PNE167.pdb",
"PNE180.pdb",
"PNE194.pdb",
"PNF125.pdb",
"PNF150.pdb",
"PNF155.pdb",
"PNF167.pdb",
"PNF170.pdb",
"PNF174.pdb",
"PNF184.pdb",
"PNG158.pdb",
"PNG21.pdb",
"PNH139.pdb",
"PNN167.pdb",
"PNS34.pdb",
"PNS53.pdb",
"PNY198.pdb",
"PPD151.pdb",
"PPD163.pdb",
"PPD168.pdb",
"PPE113.pdb",
"PPE126.pdb",
"PPE143.pdb",
"PPE150.pdb",
"PPE173.pdb",
"PPN168.pdb",
"PPN191.pdb",
"PPN194.pdb",
"PPT166.pdb",
"PPV89.pdb",
"PPY105.pdb",
"PPY106.pdb",
"PRN145.pdb",
"PRN182.pdb",
"PRN193.pdb",
"PRN194.pdb",
"PRN52.pdb",
"PRN90.pdb",
"PRQ33.pdb",
"PRQ34.pdb",
"PRQ46.pdb",
"PRR21.pdb",
"PRR24.pdb",
"PSC35.pdb",
"PSF109.pdb",
"PSF126.pdb",
"PSF129.pdb",
"PSI42.pdb",
"PSM109.pdb",
"PSM140.pdb",
"PSM79.pdb",
"PSY58.pdb",
"PTA133.pdb",
"PTC158.pdb",
"PTC184.pdb",
"PTF154.pdb",
"PTF159.pdb",
"PTF161.pdb",
"PTF163.pdb",
"PTK62.pdb",
"PTL135.pdb",
"PTL59.pdb",
"PTL66.pdb",
"PTL67.pdb",
"PTM48.pdb",
"PTM53.pdb",
"PTT139.pdb",
"PTV90.pdb",
"PTW143.pdb",
"PTW189.pdb",
"PTY70.pdb",
"PVD188.pdb",
"PVE187.pdb",
"PVE193.pdb",
"PVF161.pdb",
"PVF171.pdb",
"PVF185.pdb",
"PVN72.pdb",
"PWA186.pdb",
"PWA200.pdb",
"PWA65.pdb",
"PWE196.pdb",
"PWP65.pdb",
"PWP68.pdb",
"PWP77.pdb",
"PYF157.pdb",
"PYF160.pdb",
"PYG67.pdb",
"PYQ67.pdb",
"PYQ72.pdb",
"PYQ73.pdb",
"PYQ75.pdb",
"PYQ87.pdb",
"PYR65.pdb",
"PYR69.pdb",
"PYR71.pdb",
"PYW115.pdb",
"PYW36.pdb",
"PYW38.pdb",
"PYW74.pdb",
"PYW77.pdb",
]

M=5

#@numba.jit(nopython=False,parallel=True)
def inner_loop(data_dir, pos1, pos2, pos3, M, counter, bad):
    conformers = os.listdir(f"{data_dir}/{pos1}{pos2}{pos3}")
    for index in numba.prange(len(foo)):
        filename = foo[index]
        if filename in bad:
            continue
        counter += 1
        ##################################################################
        # get dihedral angles from structure
        # see https://biopython.org/docs/dev/api/Bio.PDB.internal_coords.html
        st = parser.get_structure(f"{pos1}{pos2}{pos3}",f"{data_dir}/{pos1}{pos2}{pos3}/{filename}")
        myChain = st[0]["X"]
        myChain.atom_to_internal_coordinates(verbose=True)
        #ic_chain = Bio.PDB.internal_coords.IC_Chain(st, verbose=True)
        #ic_chain.atom_to_internal_coordinates()
        #phipsi = ic_chain.dihedra
        residues = myChain.get_residues()
        r1 = next(residues) # n-terminal cap
        r2 = next(residues) # position 1
        r3 = next(residues) # position 2
        r4 = next(residues) # position 3
        r5 = next(residues) # c-terminal cap
        expected_fail = False
        try:
            r6 = next(residues)
        except StopIteration:
            expected_fail = True
        if not expected_fail:
            print("weird residue thing")
            #breakpoint()
        phi = r3.internal_coord.get_angle("phi")
        psi = r3.internal_coord.get_angle("psi")
        # calculate indicator functions
        # 
        if filename in bad:
            info[counter,:M] = 0 # these are high energy and should be excluded (https://osf.io/7nwu4/wiki/home/)
        else:
            info[counter,:M] = 0
        ##################################################################
        # get energies of structure
        with open(f"{data_dir}/{pos1}{pos2}{pos3}/{filename}",'r') as f:
            for counter2, line in enumerate(f):
                if counter2 < 4:
                    try:
                        info[counter,M+counter2] = float(line.split("=")[1].strip())
                    except:
                        print(f"also bad: {filename}")
                        info[counter,M+counter2] = 0
                else:
                    break
    np.save(f"extracted_info/{pos1}{pos2}{pos3}.npy",info)


for pos1 in alphabet:
    print(f"at letter: {pos1}")
    #if pos1 == "M":
    #    exit() # we've made it halfway through, will let another run take care of the rest
    for pos2 in alphabet:
        for pos3 in alphabet:
            info = np.zeros((200,M+6)) # 200 conformers by M indicators by 2 dihedral angles + 4 energies (water absolute, water relative to global min for conf., octanol absolute, octanol relative to global min for conf.)
            counter = -1
            inner_loop(data_dir, pos1, pos2, pos3, M, counter, bad)
